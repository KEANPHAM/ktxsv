@model KTXSV.Models.User
@{
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<h2 class="mb-4" style="color:#ee6823;">Chi tiết sinh viên</h2>

<div class="container border p-3 rounded" style="border-color:#ee6823;">
    <!-- Portrait -->
    @{
        var portrait = Model.StudentFiles?.FirstOrDefault(f => f.FileType == "Portrait");
    }
    @if (portrait != null)
    {
        <div class="text-start mb-4">
            <img src="@Url.Content(portrait.FilePath)" alt="Portrait" class="rounded" style="max-width:150px; max-height:150px; border:2px solid #ee6823;" />
        </div>
    }

    <!-- Thông tin sinh viên -->
    <div class="row mb-2">
        <div class="col-sm-3 fw-bold">Mã số sinh viên</div>
        <div class="col-sm-3">24DH</div>
        <div class="col-sm-3 fw-bold">Họ tên</div>
        <div class="col-sm-3">@Model.FullName</div>
    </div>
    <div class="row mb-2">
        <div class="col-sm-3 fw-bold">Giới tính</div>
        <div class="col-sm-3">@(Model.Gender == "Male" ? "Nam" : "Nữ")</div>
        <div class="col-sm-3 fw-bold">Email</div>
        <div class="col-sm-3">@Model.Email</div>
    </div>
    <div class="row mb-2">
        <div class="col-sm-3 fw-bold">Điện thoại</div>
        <div class="col-sm-3">@Model.Phone</div>
        <div class="col-sm-3 fw-bold">Ngày tạo</div>
        <div class="col-sm-3">@Model.CreatedAt.ToString()</div>
    </div>
    <div class="row mb-2">
        <div class="col-sm-3 fw-bold">Căn cước công dân</div>
        <div class="col-sm-3">0123</div>
        @{
            var currentReg = Model.Registrations?.FirstOrDefault(r => r.Status == "Active");
        }
        <div class="col-sm-3 fw-bold">Phòng hiện tại</div>
        <div class="col-sm-3">@(currentReg?.Room?.RoomNumber ?? "Chưa có")</div>
    </div>
    <div class="row mb-2">
        <div class="col-sm-3 fw-bold">Giường</div>
        <div class="col-sm-3">@(currentReg?.BedID?.ToString() ?? "Chưa có")</div>
    </div>

    <!-- Hiển thị file đã upload (không tính Portrait) -->
    <div class="row mt-3">
        <div class="col-sm-3 fw-bold">Files đã upload</div>
        <div class="col-sm-9">
            @if (Model.StudentFiles != null && Model.StudentFiles.Any())
            {
                <div class="list-group">
                    @foreach (var f in Model.StudentFiles)
                    {
                        var fileName = System.IO.Path.GetFileName(f.FilePath);
                       
                        <a href="@Url.Content(f.FilePath)" target="_blank" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                            @fileName
                        </a>
                    }
                </div>
            }
            else
            {
                <span>Chưa có file nào</span>
            }
        </div>
    </div>
    <div class="mt-3">
        <a href="@Url.Action("Index", "ManageStudents")" class="btn btn-secondary">Quay lại</a>
    </div>
</div>

<style>
    .list-group-item {
        margin-bottom: 5px;
        border-radius: 8px;
        transition: transform 0.2s;
    }

        .list-group-item:hover {
            transform: scale(1.02);
            background-color: #f8f9fa;
        }

    .fw-bold {
        font-weight: 600;
    }
</style>
