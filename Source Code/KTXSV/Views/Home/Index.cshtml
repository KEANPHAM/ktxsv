@model List<KTXSV.Models.Notification>

@{
    ViewBag.Title = "Home Page";

    string TruncateHtml(string html, int maxLength = 120)
    {
        if (string.IsNullOrEmpty(html)) return "";

        string plainText = System.Text.RegularExpressions.Regex.Replace(html, "<.*?>", String.Empty);
        plainText = plainText.Replace("&nbsp;", " ");

        if (plainText.Length <= maxLength)
            return plainText;

        int lastSpace = plainText.LastIndexOf(' ', maxLength);
        if (lastSpace > 0)
            return plainText.Substring(0, lastSpace) + "...";

        return plainText.Substring(0, maxLength) + "...";
    }
}
<link href="~/Content/btn1.css" rel="stylesheet" />
<style>
    :root {
        --custom-primary: #EE6823;
        --custom-unread-bg: #fff9f5;
    }

    .carousel-inner {
        border-radius: 20px;
        overflow: hidden;
        box-shadow: 0 8px 16px rgba(0,0,0,0.3);
    }

    .carousel-item img {
        width: 100%;
        object-fit: cover;
        transition: transform 0.6s ease;
    }

    .carousel-item.active img {
        transform: scale(1.02);
    }

    .notification-card {
        border-radius: 15px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        padding: 20px;
        background: #fff;
        transition: all 0.3s ease;
        border-left: 6px solid var(--custom-primary);
        text-decoration: none !important;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        height: 100%;
        color: inherit;
    }

        .notification-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            background: var(--custom-unread-bg);
        }

    .service-card {
        text-align: center;
        padding: 30px 15px;
        border-radius: 15px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        transition: all 0.3s;
        border: 1px solid #eee;
        display: flex;
        flex-direction: column;
        justify-content: center;
        height: 100%;
        text-decoration: none;
        color: inherit;
    }

        .service-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            background-color: #f8f9fa;
        }

        .service-card .bi {
            font-size: 3rem;
            color: var(--custom-primary);
            margin-bottom: 15px;
        }
</style>

<main>
    <!-- Header -->
    <h1 class="m-5 text-center fw-bold"
        style="color: var(--custom-primary); font-size:50px; text-shadow: 2px 4px 6px rgba(0,0,0,0.3);">
        WELCOME TO HUFLIT DORMITORY
    </h1>

    <!-- Carousel -->
    <div id="dormitoryCarousel" class="carousel slide container" data-bs-ride="carousel" data-bs-interval="4000">
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="https://sf-static.upanhlaylink.com/img/image_20251011b0988b72bdc742f2ef5e1af78f291910.jpg" class="d-block w-100" />
            </div>
            <div class="carousel-item">
                <img src="https://sf-static.upanhlaylink.com/img/image_20251011d0cc213d5e8d1ba18057811f1e682f23.jpg" class="d-block w-100" />
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#dormitoryCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon"></span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#dormitoryCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon"></span>
        </button>
    </div>

    <!-- Services Section -->
    <section class="container my-5">
        <h2 class="fw-bold text-center mb-5" style="color:#212529;">
            <i class="bi bi-gear-wide-connected me-2"></i> Dịch Vụ & Tiện Ích Sinh Viên
        </h2>
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-4 g-4">

            <!-- Đăng ký KTX (Popup hướng dẫn) -->
            <div class="col">
                <a href="#" class="service-card" data-bs-toggle="modal" data-bs-target="#dangKyModal">
                    <i class="bi bi-person-plus-fill"></i>
                    <h5 class="fw-bold text-dark">Đăng Ký Ký Túc Xá</h5>
                    <p class="text-muted mb-0">Xem hướng dẫn và nộp hồ sơ online.</p>
                </a>
            </div>

            <!-- Thanh toán -->
            <div class="col">
                <a href="@Url.Action("HoaDon", "ThanhToan")" class="service-card">
                    <i class="bi bi-credit-card-2-front-fill"></i>
                    <h5 class="fw-bold text-dark">Thanh Toán</h5>
                    <p class="text-muted mb-0">Xem và thanh toán hóa đơn tiền phòng, điện nước.</p>
                </a>
            </div>

            <!-- Hỗ trợ -->
            <div class="col">
                <a href="@Url.Action("Index", "SupportRequests")" class="service-card">
                    <i class="bi bi-wrench-adjustable-circle-fill"></i>
                    <h5 class="fw-bold text-dark">Hỗ Trợ / Sự Cố</h5>
                    <p class="text-muted mb-0">Gửi yêu cầu hỗ trợ sửa chữa hoặc báo sự cố.</p>
                </a>
            </div>

            <!-- Nội Quy (Popup) -->
            <div class="col">
                <a href="#" class="service-card" data-bs-toggle="modal" data-bs-target="#noiQuyModal">
                    <i class="bi bi-file-earmark-lock-fill"></i>
                    <h5 class="fw-bold text-dark">Nội Quy & Quy Định KTX</h5>
                    <p class="text-muted mb-0">Các quy tắc cần tuân thủ khi ở KTX.</p>
                </a>
            </div>
        </div>
    </section>

    <hr class="container my-5" />

    <!-- Notifications Section -->
    <section class="container mb-5">
        <h2 class="fw-bold text-start mb-4" style="color:var(--custom-primary);">
            <i class="me-2"></i> Thông báo mới nhất
        </h2>

        @if (Model != null && Model.Any())
        {
            <div class="row row-cols-1 row-cols-md-2 g-4">
                @foreach (var item in Model)
                {
                    <div class="col">
                        <a href="@Url.Action("ThongBao", "ThongBao", new { id = item.NotiID })" class="notification-card">
                            <h5 class="fw-bold text-uppercase">@item.Title</h5>
                            <p class="mt-2 mb-2 text-dark">@TruncateHtml(item.Content)</p>
                            <div class="d-flex justify-content-between align-items-center mt-3">
                                <small class="text-muted">
                                    <i class="bi bi-calendar3 me-1"></i>
                                    @(item.CreatedAt.HasValue ? item.CreatedAt.Value.ToString("dd/MM/yyyy HH:mm") : "N/A")
                                </small>
                                <span class="fw-bold" style="color:#0d6efd;">
                                    Xem chi tiết <i class="bi bi-arrow-right"></i>
                                </span>
                            </div>
                        </a>
                    </div>
                }
            </div>
        }
        else
        {
            <div class="alert alert-warning text-center">
                <i class="bi bi-info-circle-fill me-2"></i> Hiện chưa có thông báo nào.
            </div>
        }
    </section>
</main>

<!-- Modal Hướng dẫn Đăng ký KTX -->
<div class="modal fade" id="dangKyModal" tabindex="-1" aria-labelledby="dangKyModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title fw-bold" id="dangKyModalLabel">Hướng dẫn đăng ký Ký Túc Xá</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>Chào mừng bạn đến với Ký Túc Xá HUFLIT.</p>
                <p><strong>Bước 1:</strong> Chọn Đăng ký phòng mới để tiến hành đăng ký</p>
                <p><strong>Bước 2:</strong> Chuẩn bị đầy đủ các hồ sơ: CMND/CCCD, thẻ sinh viên hoặc giấy báo trúng tuyển, ảnh cá nhân, giấy tờ ưu tiên khác...</p>
                <p><strong>Bước 3:</strong> Chọn phòng, giường, thời hạn và thời gian đăng ký.</p>
                <p><strong>Bước 4:</strong> Gửi hồ sơ và chờ xét duyệt từ ban quản lý.</p>
                <p><strong>Bước 5:</strong> Sau khi đưuọc xét duyệt, thanh toán tiền phòng mới và các phí liên quan sẽ được gửi đến. Sau đó tiến hành thanh toán theo đúng quy định.</p>
                <hr />
            </div>
            <div class="modal-footer">
                <a href="@Url.Action("DangKyPhong", "Phong")" class="btn btn1">Đăng ký phòng</a>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="noiQuyModal" tabindex="-1" aria-labelledby="noiQuyModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title fw-bold" id="noiQuyModalLabel">HUFLIT DORMITORY</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4">
                <h4 class="fw-bold mb-4 text-center" style="color: #EE6823;">NỘI QUY KÝ TÚC XÁ SINH VIÊN HUFLIT</h4>
                <p class="text-muted mb-4">Mọi sinh viên nội trú cần đọc kỹ, cam kết và nghiêm chỉnh chấp hành các quy định sau để đảm bảo môi trường sinh hoạt an toàn, văn minh và trật tự.</p>

                <h5 class="fw-bold mb-2" style="color: #EE6823;"><i class="bi bi-clock-fill me-2"></i> Giờ Giấc Sinh Hoạt và Ra/Vào KTX</h5>
                <ul>
                    <li><strong>Giờ mở cửa:</strong> KTX mở cửa từ <strong>05:00</strong> hàng ngày.</li>
                    <li><strong>Giờ đóng cửa:</strong> KTX đóng cửa lúc <strong>23:00</strong> hàng ngày. Sinh viên cần có mặt tại KTX trước giờ đóng cửa, trừ trường hợp đặc biệt đã đăng ký và được Ban Quản Lý (BQL) KTX chấp thuận bằng văn bản.</li>
                    <li>Sinh viên phải xuất trình thẻ sinh viên hoặc thẻ nội trú khi ra vào KTX theo yêu cầu của nhân viên bảo vệ.</li>
                    <li>Tuyệt đối không tự ý mở cổng, cửa ra vào KTX hoặc đưa người lạ vào KTX khi chưa được phép của BQL.</li>
                </ul>

                <h5 class="fw-bold mb-2" style="color: #EE6823;"><i class="bi bi-shield-lock-fill me-2"></i> Trật Tự và Đảm Bảo An Ninh</h5>
                <ul>
                    <li><strong>Tuyệt đối cấm:</strong> Tàng trữ, sử dụng các chất gây nghiện, chất kích thích, vũ khí, vật liệu nổ, các văn hóa phẩm đồi trụy, hoặc tham gia cờ bạc, tệ nạn xã hội dưới mọi hình thức trong phạm vi KTX.</li>
                    <li>Không được tổ chức sinh nhật, tiệc tùng hoặc các hoạt động gây ồn ào sau <strong>22:00</strong> hoặc làm ảnh hưởng đến việc học tập, nghỉ ngơi của các phòng khác.</li>
                    <li>Khi có người thân hoặc khách đến thăm, sinh viên phải đăng ký tại phòng bảo vệ/lễ tân và chỉ tiếp khách tại khu vực được quy định (nếu có), không được phép đưa khách lên phòng ở.</li>
                    <li>Mọi sự cố hoặc vi phạm cần được báo cáo ngay lập tức cho BQL KTX.</li>
                </ul>

                <h5 class="fw-bold mb-2" style="color: #EE6823;"><i class="bi bi-house-door-fill me-2"></i> Giữ Gìn Vệ Sinh và Bảo Quản Tài Sản</h5>
                <ul>
                    <li>Sinh viên có trách nhiệm <strong>tự quản lý và giữ gìn vệ sinh chung</strong> trong phòng ở và khu vực hành lang, cầu thang được phân công.</li>
                    <li>Không được vứt rác, xả nước bừa bãi, đổ bã trà/cà phê vào bồn rửa mặt hoặc toilet. Rác phải được bỏ vào túi và tập kết đúng nơi quy định hàng ngày.</li>
                    <li>Nghiêm cấm tự ý di chuyển, thay đổi cấu trúc, hoặc tháo dỡ các tài sản, trang thiết bị cố định của KTX (giường, tủ, bàn ghế, thiết bị vệ sinh, v.v.).</li>
                    <li>Khi phát hiện hỏng hóc, phải báo ngay cho BQL để được sửa chữa kịp thời. Sinh viên cố tình làm hư hỏng phải chịu trách nhiệm bồi thường.</li>
                </ul>

                <h5 class="fw-bold mb-2" style="color: #EE6823;"><i class="bi bi-lightbulb-fill me-2"></i> PCCC và Sử Dụng Thiết Bị Điện</h5>
                <ul>
                    <li>Nghiêm cấm đun nấu (bằng bếp điện, bếp gas, bếp từ) hoặc sử dụng các thiết bị điện có công suất lớn (bàn ủi, máy sấy tóc, lò sưởi, ấm siêu tốc, tủ lạnh mini...) ngoài danh mục được phép của BQL.</li>
                    <li>Tuyệt đối không câu móc điện tùy tiện, không tự ý thay đổi hệ thống điện trong phòng.</li>
                    <li>Không tàng trữ các chất dễ cháy nổ (xăng, dầu, hóa chất...).</li>
                    <li>Khi ra khỏi phòng, sinh viên phải tắt tất cả các thiết bị điện không cần thiết để tiết kiệm điện và đảm bảo an toàn PCCC.</li>
                </ul>

                <h5 class="fw-bold mb-2" style="color: #EE6823;"><i class="bi bi-exclamation-triangle-fill me-2"></i> Các Quy Định Khác</h5>
                <ul>
                    <li>Sinh viên cần chủ động theo dõi và thực hiện các thông báo, quyết định mới nhất từ BQL KTX.</li>
                    <li>Mọi thắc mắc, kiến nghị phải được gửi đến BQL KTX qua các kênh chính thức (văn bản, email hoặc cổng thông tin sinh viên).</li>
                    <li>Bất kỳ hành vi vi phạm nội quy nào sẽ bị lập biên bản, xử lý kỷ luật tùy theo mức độ vi phạm, bao gồm cả việc buộc thôi nội trú.</li>
                </ul>

                <div class="alert alert-info mt-4" style="background-color: #fffbe6 !important" role="alert">
                    <i class="bi bi-person-check-fill me-2"></i> Sinh viên ký túc xá có trách nhiệm tự giác thực hiện và cùng nhau giám sát việc chấp hành Nội Quy này.
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
            </div>
        </div>
    </div>
</div>
